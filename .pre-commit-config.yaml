repos:
  - repo: https://github.com/pre-commit/pre-commit-hooks
    rev: v5.0.0
    hooks:
      - id: trailing-whitespace
      - id: end-of-file-fixer
      - id: check-yaml
      - id: check-added-large-files
      - id: debug-statements
      - id: check-ast
      - id: check-json
      - id: check-merge-conflict
      - id: detect-private-key

  - repo: local
    hooks:
      - id: ruff
        name: ruff (linting)
        entry: ruff check
        language: system
        types: [python]
        args: ["--config=pyproject.toml", "--fix"]

      - id: ruff-format
        name: ruff (format)
        entry: ruff format
        language: system
        types: [python]
        args: ["--config=pyproject.toml"]

      - id: mypy
        name: mypy (static type checking)
        entry: mypy
        language: system
        types: [python]
        args:
          [
            "--config-file=pyproject.toml",
            "--html-report=typing_report",
            "--txt-report=typing_report",
          ]
        exclude: ^(src_old/|tests/)

      - id: dependency-injector
        name: dependency-injector (DI patterns)
        entry: python scripts/check_dependency_injection.py
        language: system
        types: [python]
        pass_filenames: false
        args:
          [
            "--strict-constructor",
            "--check-protocols",
            "--validate-dependencies",
          ]

      - id: beartype
        name: beartype (runtime type checking)
        entry: python -c "from beartype.claw import beartype_this_package; import sys, importlib; sys.path.append('.'); import src; sys.exit(0)"
        language: python
        types: [python]
        additional_dependencies:
          [
            "beartype>=0.16.4",
            "pyyaml",
            "shapely",
            "geopandas",
            "ezdxf",
            "dependency-injector",
            "loguru",
            "jsonschema",
          ]
        pass_filenames: false

      - id: pylint
        name: pylint (source)
        entry: pylint
        language: system
        types: [python]
        args: ["--rcfile=pyproject.toml"]
        exclude: ^(src_old/|tests/)

      - id: pylint-tests
        name: pylint (tests)
        entry: pylint
        language: system
        types: [python]
        files: ^tests/
        args:
          [
            "--rcfile=pyproject.toml",
            "--disable=missing-docstring,redefined-outer-name,protected-access,unused-argument,unused-variable,duplicate-code,wrong-import-position,unnecessary-lambda,unspecified-encoding,unsupported-membership-test,use-implicit-booleaness-not-comparison,import-outside-toplevel,no-member,unexpected-keyword-arg,no-value-for-parameter,function-redefined,unused-import,invalid-sequence-index,too-many-statements",
          ]

      - id: vulture
        name: vulture (dead code and similarity)
        entry: vulture
        language: system
        types: [python]
        pass_filenames: false
        args:
          [
            "src",
            "--min-confidence=90",
            "--exclude=tests/,src_old/,scripts/",
            "--ignore-names=config_path,geometry_path,layer_path,target_path,format",
          ]

      - id: radon-cc
        name: radon (code complexity)
        entry: radon cc
        language: system
        types: [python]
        exclude: ^(src_old/|tests/|scripts/)
        pass_filenames: false
        args: ["-a", "-n", "A", "-s", "--total-average", "--xml", "src"]

      - id: radon-mi
        name: radon (maintainability)
        entry: radon mi
        language: system
        types: [python]
        exclude: ^(src_old/|tests/|scripts/)
        pass_filenames: false
        args: ["-s", "-n", "A", "--min=65", "--multi", "src"]

      - id: semgrep
        name: semgrep (semantic analysis)
        entry: semgrep
        language: system
        types: [python]
        args: ["--config=auto"]

      - id: interrogate
        name: interrogate (docstring coverage)
        entry: interrogate
        language: system
        types: [python]
        args: ["-c", "pyproject.toml", "-vv"]

      - id: pyright
        name: pyright (type checking)
        entry: pyright
        language: node
        types: [python]
        pass_filenames: false
        additional_dependencies: ["pyright@1.1.350"]

  # - repo: https://github.com/seddonym/import-linter
  #   rev: v2.2
  #   hooks:
  #     - id: import-linter
  #       name: import-linter (architecture)
  #       args: ["--config=import-linter.ini"]
