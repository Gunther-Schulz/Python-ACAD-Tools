geomLayers:
  # Administrative Boundaries
  - name: Flur
    updateDxf: true
    shapeFile: "Öffentlich Planungsbüro Schulz/Projekte/23-25 Maxsolar - Torgelow/GIS/input/flur2.shp"
    simpleLabel: flurname  # Keep this as a string
    style:
      layer:
        color: "white"
        linetype: "CONTINUOUS"
        lineweight: 13
        plot: true
        locked: false
        frozen: false
        is_on: true
        transparency: 0
      entity:
        close: true
        linetypeScale: 0.2
        linetypeGeneration: true
      text:
        height: 20.5
        font: "Arial"
        style: "Arial"
        color: "red"
        attachmentPoint: "MIDDLE_LEFT"
        paragraph:
          align: "LEFT"
    viewports:
      - name: WorkView
        style: flurWorkView

  - name: Gemarkung
    updateDxf: true
    close: true
    shapeFile: "Öffentlich Planungsbüro Schulz/Projekte/23-25 Maxsolar - Torgelow/GIS/input/gemarkung2.shp"
    simpleLabel: gmkname
    linetypeGeneration: true
    style: gemarkungsgrenze
    viewports:
      - name: WorkView
        style: gemarkungWorkView

  - name: Gemeinde
    updateDxf: true
    close: true
    shapeFile: "Öffentlich Planungsbüro Schulz/Projekte/23-25 Maxsolar - Torgelow/GIS/input/gemeinde2.shp"
    simpleLabel: gen
    linetypeGeneration: true
    style: gemeindegrenze
    viewports:
      - name: WorkView
        style: gemeindeWorkView

  - name: Parcel
    updateDxf: true
    close: true
    shapeFile: "Öffentlich Planungsbüro Schulz/Projekte/23-25 Maxsolar - Torgelow/GIS/input/parcel2.shp"
    simpleLabel: label
    style: parcel
    viewports:
      - name: WorkView
        style: parcelWorkView

  # Natural Features
  - name: Baum Points
    shapeFile: "Öffentlich Planungsbüro Schulz/Projekte/23-25 Maxsolar - Torgelow/GIS/input/bäume_input.shp"

  # Wald Group
  - name: Wald
    updateDxf: true
    close: true
    shapeFile: "Öffentlich Planungsbüro Schulz/Projekte/23-25 Maxsolar - Torgelow/GIS/input/wald.shp"
    operations:
      - type: dissolve
    viewports:
      - name: WorkView
        style: wald
    hatches:
      - name: Wald Schraffur
        style: wald
  - name: Straße
    shapeFile: "Öffentlich Planungsbüro Schulz/Projekte/23-25 Maxsolar - Torgelow/GIS/input/abstand.shp"
  - name: Straße Abstand
    operations:
      - type: buffer
        layers: 
          - Straße
        distance: 7
  - name: Weg
    shapeFile: "Öffentlich Planungsbüro Schulz/Projekte/23-25 Maxsolar - Torgelow/GIS/input/weg.shp"
  - name: Weg Abstand
    operations:
      # - type: buffer
      #   layers:
      #     - Weg
      #   distance: 1
      - type: copy
        layers:
          - Weg
  - name: FG Buffer
    operations:
      - type: buffer
        distance: 5
    shapeFile: "Öffentlich Planungsbüro Schulz/Projekte/23-25 Maxsolar - Torgelow/GIS/input/graben_input.shp"
  - name: Geltungsbereich
    updateDxf: true
    style: geltungsbereich
    operations:
      - type: copy
        layers:
          - name: Parcel
            values:
              - "81"
              - "87/1"
              - "89"
              - "95"
              - "96"
              - "97"
              - "99"
              - "100"
              - "101"
              - "102"
              - "103"
              - "104"
      - type: filterByIntersection
        layers:
          - name: Flur
            values:
              - Flur 2
          - name: Gemarkung
            values:
              - Torgelow am See
          - name: Gemeinde
            values:
              - Torgelow am See
      - type: calculate
        calculations:        
          - type: area
            as: original_area
            decimalPlaces: 0
      - type: difference
        reverseDifference: auto
        layers:
          - Wald
          - Straße Abstand
          - Weg Abstand
          - FG Buffer
      - type: filterGeometry
        minArea: 10
      # Calculate new areas and compare
      - type: calculate
        calculations:
          - type: area
            as: final_area
            decimalPlaces: 0
          - type: compare
            value1: original_area
            value2: final_area
            operator: eq
            margin: 2.0
            as: area_unchanged
      - type: report
        outputFile: "Öffentlich Planungsbüro Schulz/Projekte/23-25 Maxsolar - Torgelow/GIS/reports/geltungsbereich_report.json"
        featureColumns:
          - label
          - area_unchanged
          - original_area
          - final_area
          - Flur
          - Gemarkung
          - Gemeinde
        calculate:
          - area
        decimalPlaces:
          area: 0
      - type: dissolve
    hatches:
      - name: Geltungsbereich Schraffur
        style: geltungsbereichHatches
  - name: Geltungsbereich 2
    updateDxf: true
    linetypeScale: 1
    style: geltungsbereich_2
    operations:
      - type: buffer
        layers:
          - name: Geltungsbereich
        distance: 2
  - name: Waldabstand
    operations:
      - type: buffer
        joinStyle: mitre
        layers:
          - Wald
        distance: 30
      - type: intersection
        layers:
          - Geltungsbereich
      - type: filterGeometry
        minArea: 200
  - name: Grünflächeinput 1
    shapeFile: "Öffentlich Planungsbüro Schulz/Projekte/23-25 Maxsolar - Torgelow/GIS/input/grünfläche.shp"
  - name: Grünflächeinput 2
    operations:
      - type: copy
        layers:
          - name: Parcel
            values:
              - "97"
              - "99"
              - "100"
              - "101"
              - "102" 
      - type: filterByIntersection
        layers:
          # - name: Parcel
          #   values:
          #     - "97"
          #     - "99"
          #     - "100"
          #     - "101"
          #     - "102"
          #     # - "103"
          - name: Flur
            values:
              - Flur 2
          - name: Gemarkung
            values:
              - Torgelow am See
          - name: Gemeinde
            values:
              - Torgelow am See
  - name: Grünfläche
    updateDxf: true
    style: grünfläche
    operations:
      - type: dissolve
        useBufferTrick: true
        bufferDistance: 0.01
        # doubleUnion: true
        useAsymmetricBuffer: true
        # useSnapToGrid: true
        # mergeVertices: true
        # mergeVerticesTolerance: 20
        layers:
          - Grünflächeinput 1
          - Grünflächeinput 2
          - Waldabstand
      - type: difference
        reverseDifference: false
        layers:
          - Weg Abstand
      - type: intersection
        layers:
          - Geltungsbereich
      - type: report
        outputFile: "Öffentlich Planungsbüro Schulz/Projekte/23-25 Maxsolar - Torgelow/GIS/reports/grünfläche_report.json"
        calculate:
          - area
      - type: buffer
        distance: -3
    hatches:
      - name: Grünfläche Schraffur
        style: grünfläche
  - name: Schutzflächeumgrenzung
    updateDxf: true
    viewports:
      - name: WorkView
        style: schutzflächeWorkView
    operations:
      - type: copy
        layers:
          - Grünflächeinput 1
          - Grünflächeinput 2
          - Waldabstand
      - type: dissolve
        useBufferTrick: true
        bufferDistance: 0.01
        # doubleUnion: true
        useAsymmetricBuffer: true
        # useSnapToGrid: true
        # mergeVertices: true
        # mergeVerticesTolerance: 20
      - type: difference
        reverseDifference: false
        layers:
          - Grünfläche
      - type: intersection
        layers:
          - Geltungsbereich
    hatches:
    - name: Schutzflächeumgrenzung Schraffur
      style: schutzflächeumgrenzung
  - name: Schutzflächeumgrenzung T-Symbol Temp
    # updateDxf: true
    close: false
    plot: false
    operations:
      - type: copy
        layers:
          - Grünfläche
          - Schutzflächeumgrenzung
      - type: dissolve
      - type: intersection
        layers:
          - Geltungsbereich
      - type: filterGeometry
        minArea: 200
  - name: Baufeld
    updateDxf: true
    close: true
    viewports:
      - name: WorkView
        style: baufeld
    operations:
      - type: copy
        layers:
          - Geltungsbereich
      - type: difference
        # useBufferTrick: true
        reverseDifference: false
        layers:
          - Schutzflächeumgrenzung
          - Grünfläche
      - type: filterGeometry
        minArea: 200
    hatches:
      - name: Baufeld Schraffur
        style: baufeld
  - name: Baugrenze 2
    updateDxf: true
    style: baugrenze_2
    close: true
    operations:
      - type: buffer
        layers:
          - Baugrenze
        distance: -0.4
  - name: Baugrenze
    updateDxf: true
    style: baugrenze
    linetypeScale: 0.5
    linetypeGeneration: true
    close: true
    operations:
      - type: buffer
        layers:
          - Baufeld
        distance: -3
  - name: Baugrenze Report
    operations:
      - type: copy
        layers:
          - Baugrenze
      - type: intersection
        layers:
          - Geltungsbereich
      - type: report
        outputFile: "Öffentlich Planungsbüro Schulz/Projekte/23-25 Maxsolar - Torgelow/GIS/reports/baugrenze_report.json"
        calculate:
          - area
          - perimeter
        decimalPlaces:
          area: 0
  - name: Baufeldstreifen Report
    operations:
      - type: copy
        layers:
          - Baufeld
      - type: difference
        reverseDifference: auto
        layers:
          - Baugrenze
      - type: intersection
        layers:
          - Geltungsbereich
      - type: report
        outputFile: "Öffentlich Planungsbüro Schulz/Projekte/23-25 Maxsolar - Torgelow/GIS/reports/baufeldstreifen_report.json"
        calculate:
          - area
          - perimeter
        decimalPlaces:
          area: 0
