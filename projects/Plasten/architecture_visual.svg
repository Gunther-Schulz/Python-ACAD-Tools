<?xml version="1.0" encoding="UTF-8"?>
<svg width="1200" height="800" xmlns="http://www.w3.org/2000/svg">
  <defs>
    <!-- Patterns for hatching -->
    <pattern id="agripv-hatch" patternUnits="userSpaceOnUse" width="8" height="8">
      <path d="M0,0 L8,8 M8,0 L0,8" stroke="#4CAF50" stroke-width="0.5" opacity="0.3"/>
    </pattern>
    <pattern id="baugrenze-hatch" patternUnits="userSpaceOnUse" width="6" height="6">
      <path d="M0,3 L6,3" stroke="#2196F3" stroke-width="0.5" opacity="0.4"/>
      <path d="M3,0 L3,6" stroke="#2196F3" stroke-width="0.5" opacity="0.4"/>
    </pattern>
    <pattern id="deadzone-hatch" patternUnits="userSpaceOnUse" width="4" height="4">
      <circle cx="2" cy="2" r="0.5" fill="#FFC107" opacity="0.3"/>
    </pattern>
  </defs>
  
  <!-- Background -->
  <rect width="1200" height="800" fill="#f5f5f5"/>
  
  <!-- Title -->
  <text x="600" y="30" font-family="Arial, sans-serif" font-size="24" font-weight="bold" text-anchor="middle" fill="#333">
    Plasten Project - Layer Relationships
  </text>
  
  <!-- Wald (Forest) - Top left -->
  <rect x="50" y="80" width="180" height="280" fill="#1B5E20" stroke="#000" stroke-width="2"/>
  
  <!-- 10m gap between Wald and AgriPV (because Waldabstand 30m - 20m rule = 10m) -->
  <rect x="230" y="80" width="10" height="650" fill="#E0E0E0" stroke="#999" stroke-width="1"/>
  
  <!-- Geltungsbereich boundary (thick border) - follows AgriPV at x=240 -->
  <rect x="240" y="80" width="900" height="650" fill="none" stroke="#9C27B0" stroke-width="4"/>
  
  <!-- AgriPV area - starts at x=240 (20m before Baugrenze, NOT at Wald edge) -->
  <path d="M 240,90 L 1130,90 L 1130,720 L 240,720 Z" fill="#C8E6C9" stroke="#4CAF50" stroke-width="3"/>
  
  <!-- Dead zone portion (inside AgriPV, 20m before Baugrenze) -->
  <rect x="240" y="90" width="20" height="630" fill="url(#deadzone-hatch)"/>
  
  
  <!-- 20m FG Buffer zone around utility (excludes Baugrenze, creates dead zone) -->
  <rect x="240" y="430" width="890" height="10" fill="url(#deadzone-hatch)" opacity="0.6"/>
  <rect x="240" y="460" width="890" height="10" fill="url(#deadzone-hatch)" opacity="0.6"/>
  
  <!-- Dead zone - general 20m border from AgriPV edge -->
  <path d="M 240,90 L 1130,90 L 1130,110 L 240,110 Z" fill="url(#deadzone-hatch)"/>
  <path d="M 240,700 L 1130,700 L 1130,720 L 240,720 Z" fill="url(#deadzone-hatch)"/>
  <path d="M 1110,90 L 1130,90 L 1130,720 L 1110,720 Z" fill="url(#deadzone-hatch)"/>
  
  <!-- Baugrenze (construction boundary) - 20m inset from AgriPV on all sides, plus buffer exclusions -->
  <!-- Split into sections to show gaps where utility buffers exclude Baugrenze -->
  <!-- Above utility line -->
  <rect x="260" y="110" width="850" height="310" fill="#BBDEFB" stroke="#2196F3" stroke-width="2"/>
  <!-- Below utility line (avoiding the 40m FG Buffer zone) -->
  <rect x="260" y="470" width="850" height="230" fill="#BBDEFB" stroke="#2196F3" stroke-width="2"/>
  
  <!-- Legend -->
  <g transform="translate(50, 450)">
    <text x="0" y="0" font-family="Arial, sans-serif" font-size="16" font-weight="bold" fill="#333">
      Legend:
    </text>
    
    <!-- Wald -->
    <rect x="0" y="15" width="30" height="20" fill="#1B5E20" stroke="#000" stroke-width="1"/>
    <text x="40" y="30" font-family="Arial, sans-serif" font-size="12" fill="#333">
      Wald (Forest) - Excluded from everything
    </text>
    
    <!-- AgriPV -->
    <rect x="0" y="45" width="30" height="20" fill="#C8E6C9" stroke="#4CAF50" stroke-width="2"/>
    <text x="40" y="60" font-family="Arial, sans-serif" font-size="12" fill="#333">
      AgriPV - Solar planning zone
    </text>
    
    <!-- Baugrenze -->
    <rect x="0" y="75" width="30" height="20" fill="#BBDEFB" stroke="#2196F3" stroke-width="2"/>
    <text x="40" y="90" font-family="Arial, sans-serif" font-size="12" fill="#333">
      Baugrenze - Where panels actually go
    </text>
    
    <!-- Dead zone -->
    <rect x="0" y="105" width="30" height="20" fill="url(#deadzone-hatch)" stroke="#FFC107" stroke-width="1"/>
    <text x="40" y="120" font-family="Arial, sans-serif" font-size="12" fill="#333">
      Dead zone - AgriPV but not Baugrenze
    </text>
    
    <!-- Biotope -->
    <ellipse cx="15" cy="145" rx="15" ry="10" fill="#E91E63" stroke="#880E4F" stroke-width="2"/>
    <text x="40" y="150" font-family="Arial, sans-serif" font-size="12" fill="#333">
      Biotope - Excluded from both (AgriPV &amp; Baugrenze)
    </text>
    
    <!-- Utility line -->
    <line x1="0" y1="175" x2="30" y2="175" stroke="#FF5722" stroke-width="3"/>
    <text x="40" y="180" font-family="Arial, sans-serif" font-size="12" fill="#333">
      Utility line - Can run through AgriPV
    </text>
    
    <!-- Geltungsbereich -->
    <rect x="0" y="195" width="30" height="20" fill="none" stroke="#9C27B0" stroke-width="3"/>
    <text x="40" y="210" font-family="Arial, sans-serif" font-size="12" fill="#333">
      Geltungsbereich - Follows AgriPV outline
    </text>
  </g>
  
  <!-- Annotations -->
  <g>
    <!-- Arrow showing Waldabstand 30m total from Wald -->
    <line x1="230" y1="380" x2="260" y2="380" stroke="#FF9800" stroke-width="2"/>
    <line x1="230" y1="380" x2="230" y2="370" stroke="#FF9800" stroke-width="2"/>
    <line x1="260" y1="380" x2="260" y2="370" stroke="#FF9800" stroke-width="2"/>
    <text x="245" y="365" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#FF9800">
      Waldabstand 30m total
    </text>
    <text x="245" y="395" font-family="Arial, sans-serif" font-size="9" text-anchor="middle" fill="#666">
      (10m gap + 20m dead zone)
    </text>
    
    <!-- Arrow showing 20m dead zone from AgriPV edge to Baugrenze -->
    <line x1="240" y1="650" x2="260" y2="650" stroke="#FFC107" stroke-width="2"/>
    <line x1="240" y1="650" x2="240" y2="640" stroke="#FFC107" stroke-width="2"/>
    <line x1="260" y1="650" x2="260" y2="640" stroke="#FFC107" stroke-width="2"/>
    <text x="250" y="665" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#F57C00" font-weight="bold">
      20m
    </text>
    <text x="250" y="678" font-family="Arial, sans-serif" font-size="9" text-anchor="middle" fill="#666">
      (AgriPV to Baugrenze)
    </text>
    
    <!-- Key insight callout -->
    <rect x="50" y="690" width="220" height="50" fill="#FFF9C4" stroke="#F57F17" stroke-width="2" rx="5"/>
    <text x="160" y="710" font-family="Arial, sans-serif" font-size="11" font-weight="bold" text-anchor="middle" fill="#F57F17">
      KEY INSIGHT:
    </text>
    <text x="160" y="720" font-family="Arial, sans-serif" font-size="9" text-anchor="middle" fill="#333">
      AgriPV must always be 20m
    </text>
    <text x="160" y="732" font-family="Arial, sans-serif" font-size="9" text-anchor="middle" fill="#333">
      from Baugrenze. Where buffers
    </text>
    <text x="160" y="744" font-family="Arial, sans-serif" font-size="9" text-anchor="middle" fill="#333">
      &gt;20m, AgriPV gets trimmed!
    </text>
  </g>
  
  <!-- Bottom note -->
  <text x="600" y="770" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="#666" font-style="italic">
    Note: Waldabstand/FG Buffer/etc. are buffer zones used ONLY for Baugrenze calculation, NOT for AgriPV.
  </text>
  <text x="600" y="785" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="#666" font-style="italic">
    Dead zones are the RESULT: AgriPV extends to Wald/utilities/roads, but Baugrenze must maintain buffer distances.
  </text>
  
  <!-- TOP LAYER: Biotopes, utility lines and all text (render last so they appear on top) -->
  <g id="topLayer">
    <!-- Biotope patches (on top of everything, filled to show complete exclusion) -->
    <ellipse cx="380" cy="200" rx="40" ry="30" fill="#E91E63" stroke="#880E4F" stroke-width="3"/>
    <ellipse cx="920" cy="300" rx="35" ry="25" fill="#E91E63" stroke="#880E4F" stroke-width="3"/>
    
    <!-- Utility line -->
    <line x1="240" y1="450" x2="1130" y2="450" stroke="#FF5722" stroke-width="3"/>
    <circle cx="480" cy="450" r="3" fill="#FF5722"/>
    <circle cx="680" cy="450" r="3" fill="#FF5722"/>
    <circle cx="880" cy="450" r="3" fill="#FF5722"/>
    
    <!-- All text labels on top -->
    <text x="690" y="60" font-family="Arial, sans-serif" font-size="14" font-weight="bold" text-anchor="middle" fill="#9C27B0">
      Geltungsbereich (follows AgriPV outline)
    </text>
    <text x="140" y="210" font-family="Arial, sans-serif" font-size="16" font-weight="bold" text-anchor="middle" fill="#fff">
      WALD
    </text>
    <text x="140" y="230" font-family="Arial, sans-serif" font-size="12" text-anchor="middle" fill="#fff">
      (Forest)
    </text>
    <text x="140" y="250" font-family="Arial, sans-serif" font-size="12" text-anchor="middle" fill="#fff">
      Completely
    </text>
    <text x="140" y="265" font-family="Arial, sans-serif" font-size="12" text-anchor="middle" fill="#fff">
      Excluded
    </text>
    <text x="235" y="400" font-family="Arial, sans-serif" font-size="9" text-anchor="middle" fill="#666" transform="rotate(-90 235 400)">
      10m gap (not in AgriPV)
    </text>
    <text x="685" y="120" font-family="Arial, sans-serif" font-size="18" font-weight="bold" text-anchor="middle" fill="#2E7D32">
      AgriPV (Planning Zone - Solar Designation)
    </text>
    <text x="250" y="400" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#F57C00" transform="rotate(-90 250 400)">
      20m dead zone
    </text>
    <text x="380" y="205" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#fff" font-weight="bold">
      Biotope
    </text>
    <text x="920" y="305" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#fff" font-weight="bold">
      Biotope
    </text>
    <text x="685" y="440" font-family="Arial, sans-serif" font-size="12" text-anchor="middle" fill="#FF5722" font-weight="bold">
      FG Utility Line (runs through AgriPV)
    </text>
    <text x="320" y="427" font-family="Arial, sans-serif" font-size="9" fill="#F57C00">
      FG Buffer 20m (dead zone)
    </text>
    <text x="320" y="483" font-family="Arial, sans-serif" font-size="9" fill="#F57C00">
      FG Buffer 20m (dead zone)
    </text>
    <text x="685" y="105" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#F57C00">
      Dead zone (20m from AgriPV edge)
    </text>
    <text x="670" y="270" font-family="Arial, sans-serif" font-size="20" font-weight="bold" text-anchor="middle" fill="#0D47A1">
      BAUGRENZE
    </text>
    <text x="670" y="295" font-family="Arial, sans-serif" font-size="14" text-anchor="middle" fill="#0D47A1">
      (Construction Boundary)
    </text>
    <text x="670" y="315" font-family="Arial, sans-serif" font-size="12" text-anchor="middle" fill="#1565C0">
      Actual solar panels installed here
    </text>
  </g>
  
</svg>

