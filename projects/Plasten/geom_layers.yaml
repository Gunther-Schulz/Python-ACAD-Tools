geomLayers:
  - name: "Blendschutzzaun"
    shapeFile: "Öffentlich Planungsbüro Schulz/Projekte/23-24 Maxsolar - Plasten/GIS/input/blendschutzzaun.shp"  # Required: this is the source for further processing
    style: blendschutzzaun
    sync: push
  # - name: EinAusfahrt Points
  #   type: "points"
  #   shapeFile: "Öffentlich Planungsbüro Schulz/Projekte/23-24 Maxsolar - Plasten/GIS/input/einausfahrt_points.shp"
  - name: EinAusfahrt Line
    sync: push
    style:
      layer:
        color: "magenta"
        lineweight: 50
        plot: false
    type: "line"
    shapeFile: "Öffentlich Planungsbüro Schulz/Projekte/23-24 Maxsolar - Plasten/GIS/input/einausfahrt_line.shp"
  - name: Baufeld Label Points
    type: "points"
    shapeFile: "Öffentlich Planungsbüro Schulz/Projekte/23-24 Maxsolar - Plasten/GIS/input/baufeld_label_points.shp"
  - name: Baum Points
    sync: push
    style:
      layer:
        color: "green"
        plot: false
    shapeFile: "Öffentlich Planungsbüro Schulz/Projekte/23-24 Maxsolar - Plasten/GIS/input/baum_points.shp"
  - name: Flur
    sync: push
    close: true
    shapeFile: "Öffentlich Planungsbüro Schulz/Projekte/23-24 Maxsolar - Plasten/GIS/input/flur.shp"
    label: flurname
    linetypeScale: 0.2
    linetypeGeneration: true
    style: flurgrenze
    viewports:
      - name: WorkView
        style: flurWorkView
  - name: Parcel
    # sync: push # Don't enable. Moved Numbers already in DXF
    close: true
    shapeFile: "Öffentlich Planungsbüro Schulz/Projekte/23-24 Maxsolar - Plasten/GIS/input/parcel.shp"
    label: label
    style: parcel
    viewports:
      - name: WorkView
        style: parcelWorkView
  - name: Gemarkung
    sync: push
    close: true
    shapeFile: "Öffentlich Planungsbüro Schulz/Projekte/23-24 Maxsolar - Plasten/GIS/input/gemarkung.shp"
    label: gmkname
    linetypeGeneration: true
    style: gemarkungsgrenze
    viewports:
      - name: WorkView
        style: gemarkungWorkView
  - name: Gemeinde
    sync: push
    close: true
    shapeFile: "Öffentlich Planungsbüro Schulz/Projekte/23-24 Maxsolar - Plasten/GIS/input/gemeinde.shp"
    label: gen
    # linetypeScale: 0.2
    linetypeGeneration: true
    style: gemeindegrenze
    viewports:
      - name: WorkView
        style: gemeindeWorkView
  - name: Include Ausgleichsfläche
    shapeFile: "Öffentlich Planungsbüro Schulz/Projekte/23-24 Maxsolar - Plasten/GIS/input/Include Ausgleichsfläche.shp"
  # - name: Grünfläche Input 
  #   shapeFile: "Öffentlich Planungsbüro Schulz/Projekte/23-24 Maxsolar - Plasten/GIS/input/grünfläche_input_2.shp"
  - name: Wald
    sync: push
    shapeFile: "Öffentlich Planungsbüro Schulz/Projekte/23-24 Maxsolar - Plasten/GIS/input/wald.shp"
    close: true
    viewports:
      - name: WorkView
        style: waldWorkView
    operations:
      - type: dissolve
  - name: Wald Schraffur
    sync: push
    style: wald
    viewports:
      - name: WorkView
        style: waldWorkView
    applyHatch:
      layers:
        - Wald
  - name: Biotope Input
    shapeFile: "Öffentlich Planungsbüro Schulz/Projekte/23-24 Maxsolar - Plasten/GIS/input/biotope.shp"
  - name: Exclude Baufeld
    shapeFile: "Öffentlich Planungsbüro Schulz/Projekte/23-24 Maxsolar - Plasten/GIS/input/Exclude Baufeld.shp"
  - name: Exclude Baugrenze
    shapeFile: "Öffentlich Planungsbüro Schulz/Projekte/23-24 Maxsolar - Plasten/GIS/input/Exclude Baugrenze.shp"
  - name: Exclude Geltungsbereich
    shapeFile: "Öffentlich Planungsbüro Schulz/Projekte/23-24 Maxsolar - Plasten/GIS/input/exclude_v2.shp"
  - name: Baumabstand Puffer
    shapeFile: "Öffentlich Planungsbüro Schulz/Projekte/23-24 Maxsolar - Plasten/GIS/input/baum_abstand.shp"
    operations:
      - type: buffer
        capStyle: flat
        distance: 5
        joinStyle: mitre
  - name: Geschütze Biotope
    # sync: push
    style:
      layer:
        plot: false
    shapeFile: "Öffentlich Planungsbüro Schulz/Projekte/23-24 Maxsolar - Plasten/GIS/input/gesch_biotope.shp"
  - name: Geschütze Biotope 2
    # sync: push
    # linetypeScale: 0.2
    linetypeGeneration: true
    style: gesGeschuetzesBiotop
    operations:
      - type: buffer
        layers:
          - Geschütze Biotope
        distance: 0.5
        joinStyle: mitre
  - name: Ontras_FG_buffer_4
    # sync: push
    style:
      layer:
        color: "orange"
        plot: false
    shapeFile: "Öffentlich Planungsbüro Schulz/Projekte/23-24 Maxsolar - Plasten/GIS/input/Ontras_FG_buffer_4.shp"
  - name: Ontras_FG_buffer_4 Buffer
    operations:
      - type: buffer
        layers:
          - Ontras_FG_buffer_4
        distance: 4
        joinStyle: round
        capStyle: round
        quadSegs: 32
  - name: Ontras_FG_buffer_2
    # sync: push
    style:
      layer:
        color: "orange"
        plot: false
    shapeFile: "Öffentlich Planungsbüro Schulz/Projekte/23-24 Maxsolar - Plasten/GIS/input/Ontras_FG_buffer_2.shp"
  - name: Gastrasse
    operations:
      - type: copy
        layers:
          - Ontras_FG_buffer_2
          - Ontras_FG_buffer_4
  - name: Ontras_FG_buffer_2 Buffer
    operations:
      - type: buffer
        layers:
          - Ontras_FG_buffer_2
        distance: 2
        joinStyle: round
        capStyle: round
        quadSegs: 32
  - name: Gastrasse Buffer
    operations:
      - type: copy
        layers:
          - Ontras_FG_buffer_4 Buffer
          - Ontras_FG_buffer_2 Buffer
      - type: dissolve
  - name: Straßenflurstückskante
    shapeFile: "Öffentlich Planungsbüro Schulz/Projekte/23-24 Maxsolar - Plasten/GIS/input/straßenflürstückskante.shp"
  # - name: Heckenkante
  #   shapeFile: "Öffentlich Planungsbüro Schulz/Projekte/23-24 Maxsolar - Plasten/GIS/input/heckenkante.shp"
  - name: Einfahrt Line Reference
    shapeFile: "Öffentlich Planungsbüro Schulz/Projekte/23-24 Maxsolar - Plasten/GIS/input/einfahrt_line.shp"
  - name: FG_Unterirdisch
    sync: push
    # style:
    #   layer:
    #     color: "blue"
    #     plot: false
    shapeFile: "Öffentlich Planungsbüro Schulz/Projekte/23-24 Maxsolar - Plasten/GIS/input/FG_Unterirdisch.shp"
  - name: FG_Oberirdisch
    sync: push
    # style:
    #   layer:
    #     color: "blue"
    #     plot: false
    shapeFile: "Öffentlich Planungsbüro Schulz/Projekte/23-24 Maxsolar - Plasten/GIS/input/FG_Oberirdisch.shp"
  - name: FG Line
    operations:
      - type: merge
        layers:
          - FG_Unterirdisch
          - FG_Oberirdisch
  - name: FG Buffer
    operations:
      - type: copy
        layers:
          - FG Line
      - type: dissolve
      - type: buffer
        distance: 20
        joinStyle: round
        capStyle: round
        quadSegs: 32
  - name: Gebäude 150m Abstand Buffer
    # sync: push
    operations:
      - type: buffer
        distance: 150
        joinStyle: mitre
    shapeFile: "Öffentlich Planungsbüro Schulz/Projekte/23-24 Maxsolar - Plasten/GIS/input/gebäude_150m_abstand.shp"
  - name: Geltungsbereich NW Base
    # sync: push  # Don't sync - this is for calculations only
    style: geltungsbereich
    operations:
      - type: copy
        layers:
          - name: Parcel
            values:
              - "1"
              - "2"
              - "4"
              - "6"
              - "7"
              - "14"
      - type: filterByIntersection
        layers:
          - name: Flur
            values:
              - "Flur 1"
          - name: Gemarkung
            values:
              - "Groß Plasten"
          - name: Gemeinde
            values:
              - "Groß Plasten"
      - type: calculate
        calculations:
          - type: area
            as: original_area
            decimalPlaces: 0
      - type: difference
        layers:
          - Wald
          - Baumabstand Puffer
          - Exclude Geltungsbereich
        reverseDifference: false
      - type: filterGeometry
        minArea: 10
      # Calculate new areas and compare
      - type: calculate
        calculations:
          - type: area
            as: final_area
            decimalPlaces: 0
          - type: compare
            value1: original_area
            value2: final_area
            operator: eq
            margin: 2.0
            as: area_unchanged
      - type: report
        outputFile: "Öffentlich Planungsbüro Schulz/Projekte/23-24 Maxsolar - Plasten/GIS/reports/geltungsbereich_6_report.json"
        featureColumns:
          - label
          - area_unchanged
          - original_area
          - final_area
          - Flur
          - Gemarkung
          - Gemeinde
        calculate:
          - area
        decimalPlaces:
          area: 0
      - type: dissolve
  - name: Geltungsbereich NW 2
    sync: push
    linetypeScale: 1
    style: geltungsbereich_2
    operations:
      - type: buffer
        layers:
          - name: Geltungsbereich NW
        distance: 2
        joinStyle: mitre
  # - name: Geltungsbereich Hatch NW
  #   sync: push
  #   style: geltungsbereichHatches
  #   applyHatch:
  #     layers:
  #       - Geltungsbereich NW
  # - name: Geltungsbereich Hatch NO
  #   sync: push
  #   style: geltungsbereichHatches
  #   applyHatch:
  #     layers:
  #       - Geltungsbereich NO
  # - name: Geltungsbereich Hatch S
  #   sync: push
  #   style: geltungsbereichHatches
  #   applyHatch:
  #     layers:
  #       - Geltungsbereich S
  - name: Geltungsbereich NO Base
    # sync: push  # Don't sync - this is for calculations only
    style: geltungsbereich
    close: true
    operations:
      - type: copy
        layers:
          - name: Parcel
            values:
              - "24/8"
              - "24/9"
      - type: filterByIntersection
        layers:
          - name: Flur
            values:
              - "Flur 1"
          - name: Gemarkung
            values:
              - "Groß Plasten"
          - name: Gemeinde
            values:
              - "Groß Plasten"
      - type: calculate
        calculations:
          - type: area
            as: original_area
            decimalPlaces: 0
      - type: difference
        # useBufferTrick: true
        layers:
          - Wald
          - Baumabstand Puffer
          - Exclude Geltungsbereich
        reverseDifference: false
      - type: filterGeometry
        minArea: 10
      # Calculate new areas and compare
      - type: calculate
        calculations:
          - type: area
            as: final_area
            decimalPlaces: 0
          - type: compare
            value1: original_area
            value2: final_area
            operator: eq
            margin: 2.0
            as: area_unchanged
      - type: report
        outputFile: "Öffentlich Planungsbüro Schulz/Projekte/23-24 Maxsolar - Plasten/GIS/reports/geltungsbereich_5_report.json"
        featureColumns:
          - label
          - area_unchanged
          - original_area
          - final_area
          - Flur
          - Gemarkung
          - Gemeinde
        calculate:
          - area
        decimalPlaces:
          area: 0
      - type: dissolve
  - name: Geltungsbereich NO 2
    sync: push
    linetypeScale: 1
    style: geltungsbereich_2
    operations:
      - type: buffer
        layers:
          - name: Geltungsbereich NO
        distance: 2
        joinStyle: mitre
  - name: Geltungsbereich S Base
    # sync: push  # Don't sync - this is for calculations only
    style: geltungsbereich
    close: true
    operations:
      - type: copy
        layers:
          - name: Parcel
            values:
              - "41/1"
      - type: filterByIntersection
        layers:
          - name: Flur
            values:
              - "Flur 2"
          - name: Gemarkung
            values:
              - "Klein Plasten"
          - name: Gemeinde
            values:
              - "Groß Plasten"
      - type: calculate
        calculations:
          - type: area
            as: original_area
            decimalPlaces: 0
      - type: difference
        layers:
          - Wald
          - Baumabstand Puffer
          - Exclude Geltungsbereich
        reverseDifference: false
      - type: filterGeometry
        minArea: 10
      # Calculate new areas and compare
      - type: calculate
        calculations:
          - type: area
            as: final_area
            decimalPlaces: 0
          - type: compare
            value1: original_area
            value2: final_area
            operator: eq
            margin: 2.0
            as: area_unchanged
      - type: report
        outputFile: "Öffentlich Planungsbüro Schulz/Projekte/23-24 Maxsolar - Plasten/GIS/reports/geltungsbereich_7_report.json"
        featureColumns:
          - label
          - area_unchanged
          - original_area
          - final_area
          - Flur
          - Gemarkung
          - Gemeinde
        calculate:
          - area
        decimalPlaces:
          area: 0
      - type: dissolve
  - name: Geltungsbereich S 2
    sync: push
    linetypeScale: 1
    style: geltungsbereich_2
    operations:
      - type: buffer
        layers:
          - name: Geltungsbereich S
        distance: 2
        joinStyle: mitre
  - name: Geltungsbereich Hatch NW
    sync: push
    style: geltungsbereichHatches
    applyHatch:
      layers:
        - Geltungsbereich NW
  - name: Geltungsbereich Hatch NO
    sync: push
    style: geltungsbereichHatches
    applyHatch:
      layers:
        - Geltungsbereich NO
  - name: Geltungsbereich Hatch S
    sync: push
    style: geltungsbereichHatches
    applyHatch:
      layers:
        - Geltungsbereich S
  - name: Einfahrt Line
    operations:
      - type: directionalLine
        relativeAngle: true
        length: 23
        angle: 270
        layers:
          - Einfahrt Line Reference
  - name: Einfahrt
    # sync: push
    close: true
    operations:
      - type: buffer
        startCapStyle: round
        endCapStyle: flat
        joinStyle: mitre
        layers:
          - Einfahrt Line
        distance: 5
      - type: intersection
        layers:
          - Geltungsbereich NW Base
          - Geltungsbereich NO Base
          - Geltungsbereich S Base
      - type: dissolve
        useBufferTrick: true
  
  # - name: Einfahrt Schraffur
  #   sync: push
  #   style: verkehrsfläche
  #   applyHatch:
  #     layers:
  #       - Einfahrt
  # - name: Heckenkante Buffer
  #   operations:
  #     - type: buffer
  #       layers:
  #         - Heckenkante
  #       distance: 5
  #     - type: difference
  #       reverseDifference: false
  #       # useBufferTrick: true
  #       layers:
  #         - Gastrasse Buffer
  #         - Einfahrt
  #     - type: intersection
  #       layers:
  #         - Geltungsbereich NW
  #         - Geltungsbereich NO
  #         - Geltungsbereich S
  - name: Straßenflurstückskante Buffer 20m
    operations:
      - type: buffer
        layers:
          - Straßenflurstückskante
        distance: 20
        joinStyle: mitre
      # - type: difference
      #   reverseDifference: false # default is "auto"
      #   layers:
      #     - Heckenkante Buffer
  - name: Waldabstand
    operations:
      - type: buffer
        layers:
          - Wald
        distance: 30
        joinStyle: round
        capStyle: round
        quadSegs: 32
      # - type: difference
      #   reverseDifference: false
      #   layers:
      #     - Heckenkante Buffer
      - type: intersection
        layers:
          - Geltungsbereich NW Base
          - Geltungsbereich NO Base
          - Geltungsbereich S Base
      - type: filterGeometry
        minArea: 200
  - name: Biotope
    # sync: push
    style:
      layer:
        plot: false
    viewports:
      - name: WorkView
        style: biotopWorkView
    operations:
      - type: dissolve
        layers:
          - Biotope Input
          - Geschütze Biotope
  # - name: Biotope Ausserhalb Geltungsbereich
  #   sync: push
  #   operations:
  #     - type: copy
  #       layers:
  #         - Biotope
  #     - type: difference
  #       layers:
  #         - Geltungsbereich NW
  #         - Geltungsbereich NO
  #         - Geltungsbereich S
  #       reverseDifference: false
  - name: Biotope Innerhalb Geltungsbereich
    operations:
      - type: copy
        layers:
          - Biotope
      - type: intersection
        layers:
          - Geltungsbereich NW Base
          - Geltungsbereich NO Base
          - Geltungsbereich S Base

  - name: Biotop Report NW
    operations:
      - type: copy
        layers:
          - Biotope Innerhalb Geltungsbereich
      - type: intersection
        layers:
          - Geltungsbereich NW
      - type: report
        outputFile: "Öffentlich Planungsbüro Schulz/Projekte/23-24 Maxsolar - Plasten/GIS/reports/biotop_report_nw.json"
        calculate:
          - area
          - perimeter
        decimalPlaces:
          area: 0
  - name: Biotop Report S
    operations:
      - type: copy
        layers:
          - Biotope Innerhalb Geltungsbereich
      - type: intersection
        layers:
          - Geltungsbereich S
      - type: report
        outputFile: "Öffentlich Planungsbüro Schulz/Projekte/23-24 Maxsolar - Plasten/GIS/reports/biotop_report_s.json"
        calculate:
          - area
          - perimeter
        decimalPlaces:
          area: 0
  - name: Biotoppuffer
    # sync: push
    viewports:
      - name: WorkView
        style:
          color: "brilliant-green"
          linetype: "ACAD_ISO02W100"
    operations:
      - type: buffer
        layers:
          - Biotope
        distance: 10
        joinStyle: mitre
  - name: Soft Exclusions
    # sync: push
    # These are areas AgriPV can expand 20m into (like Waldabstand, utility buffers, etc.)
    operations:
      - type: copy
        layers:
          - Include Ausgleichsfläche
          - FG Buffer
          - Gastrasse Buffer
          - Gebäude 150m Abstand Buffer
          - Waldabstand
          - Baumabstand Puffer
          - Straßenflurstückskante Buffer 20m
      - type: dissolve
        useBufferTrick: true
  - name: Hard Exclusions
    # sync: push
    # These are areas AgriPV can NEVER be in (Biotopes, manual exclusions)
    operations:
      - type: copy
        layers:
          - Biotope
          - Biotoppuffer
          - Exclude Baufeld
      - type: dissolve
        useBufferTrick: true
  - name: Landwirtschaftliche Nutzung Base
    # sync: push
    operations:
      - type: copy
        layers:
          - Soft Exclusions
      - type: intersection
        layers:
          - Geltungsbereich NW Base
          - Geltungsbereich NO Base
          - Geltungsbereich S Base
      - type: difference
        layers:
          - AgriPV
        reverseDifference: false
        useBufferTrick: true
  - name: Landwirtschaftliche Nutzung Report NW
    operations:
      - type: copy
        layers:
          - Landwirtschaftliche Nutzung
      - type: intersection
        layers:
          - Geltungsbereich NW
      - type: report
        outputFile: "Öffentlich Planungsbüro Schulz/Projekte/23-24 Maxsolar - Plasten/GIS/reports/grünfläche_schutzfläche_report_nw.json"
        calculate:
          - area
          - perimeter
        decimalPlaces:
          area: 0
  - name: Landwirtschaftliche Nutzung Report NO
    operations:
      - type: copy
        layers:
          - Landwirtschaftliche Nutzung
          # - Hecke
      - type: intersection
        layers:
          - Geltungsbereich NO
      - type: report
        outputFile: "Öffentlich Planungsbüro Schulz/Projekte/23-24 Maxsolar - Plasten/GIS/reports/grünfläche_schutzfläche_report_no.json"
        calculate:
          - area
          - perimeter
        decimalPlaces:
          area: 0
  - name: Landwirtschaftliche Nutzung Report S
    operations:
      - type: copy
        layers:
          - Landwirtschaftliche Nutzung
      - type: intersection
        layers:
          - Geltungsbereich S
      - type: report
        outputFile: "Öffentlich Planungsbüro Schulz/Projekte/23-24 Maxsolar - Plasten/GIS/reports/grünfläche_schutzfläche_report_s.json"
        calculate:
          - area
          - perimeter
        decimalPlaces:
          area: 0
  - name: Ausgleich Grünfläche
    sync: push
    viewports:
      - name: WorkView
        style: grünflächeWorkView
    operations:
      - type: buffer
        layers:
          - Landwirtschaftliche Nutzung
        distance: -3
        joinStyle: mitre
    # bluntAngles:
    #   angleThreshold: 25  # Angles smaller than this will be blunted
    #   distance: 10.0  # Distance to move the vertex along the angle bisector
  - name: Ausgleich Grünfläche Schraffur
    sync: push
    style: grünfläche
    applyHatch:
      layers:
        - Ausgleich Grünfläche
  - name: Ausgleich Schutzflächeumgrenzung
    sync: push
    viewports:
      - name: WorkView
        style: schutzflächeWorkView
    operations:
      - type: copy
        layers:
          - Landwirtschaftliche Nutzung
      - type: difference
        layers:
          - Ausgleich Grünfläche
        reverseDifference: false
      - type: intersection
        layers:
          - Geltungsbereich NW Base
          - Geltungsbereich NO Base
          - Geltungsbereich S Base
      # - type: filterGeometry
      #   minArea: 200
  # - name: Hecke
  #   sync: push
  #   operations:
  #     - type: copy
  #       layers:
  #         - Heckenkante Buffer
  #     - type: difference
  #       reverseDifference: false
  #       useBufferTrick: true
  #       layers:
  #         - Ausgleichsfläche Gesamt
  #     - type: filterGeometry
  #       minArea: 10
  # - name: Hecke Schraffur
  #   sync: push
  #   style: grünfläche
  #   applyHatch:
  #     layers:
  #       - Hecke
  # - name: Biotoppuffer
  #   sync: push
  #   viewports:
  #     - name: WorkView
  #       style:
  #         color: "brilliant-green"
  #         linetype: "ACAD_ISO02W100"
  #   operations:
  #     - type: buffer
  #       layers:
  #         - Biotope
  #       distance: 10
      # - type: difference
      #   operations:
      #     - type: dissolve
      #       layers:
      #         - Biotope
      #         - Ausgleichsfläche Gesamt
      #   reverseDifference: false
      # - type: intersection
      #   layers:
      #     - Geltungsbereich NW
      #     - Geltungsbereich NO
      #     - Geltungsbereich S
  # - name: Biotoppuffer Schraffur
  #   sync: push
  #   style: grünfläche
  #   applyHatch:
  #     layers:
  #       - Biotoppuffer
  # - name: Biotoppuffer Report NW
  #   operations:
  #     - type: copy
  #       layers:
  #         - Biotoppuffer
  #     - type: intersection
  #       layers:
  #         - Geltungsbereich NW
  #     - type: report
  #       outputFile: "Öffentlich Planungsbüro Schulz/Projekte/23-24 Maxsolar - Plasten/GIS/reports/biotoppuffer_report_nw.json"
  #       calculate:
  #         - area
  #         - perimeter
  #       decimalPlaces:
  #         area: 0
  # - name: Biotoppuffer Report S
  #   operations:
  #     - type: copy
  #       layers:
  #         - Biotoppuffer
  #     - type: intersection
  #       layers:
  #         - Geltungsbereich S
  #     - type: report
  #       outputFile: "Öffentlich Planungsbüro Schulz/Projekte/23-24 Maxsolar - Plasten/GIS/reports/biotoppuffer_report_s.json"
  #       calculate:
  #         - area
  #         - perimeter
  #       decimalPlaces:
  #         area: 0
  - name: Schutzflächeumgrenzung T-Symbol Temp
    # sync: push
    close: false
    plot: false
    operations:
      - type: copy
        layers:
          - Landwirtschaftliche Nutzung
          # - Biotope Innerhalb Geltungsbereich
      - type: dissolve
      - type: intersection
        layers:
          - Geltungsbereich NW Base
          - Geltungsbereich NO Base
          - Geltungsbereich S Base
      - type: filterGeometry
        minArea: 200
  # - name: Schutzflächeumgrenzung T-Small Temp
  #   # sync: push
  #   close: false
  #   plot: false
  #   operations:
  #     - type: copy
  #       layers:
  #         - Grünfläche
  #         - Schutzflächeumgrenzung
  #     - type: dissolve
  #     - type: intersection
  #       layers:
  #         - Geltungsbereich NW
  #         - Geltungsbereich NO
  #         - Geltungsbereich S
  #     - type: filterGeometry
  #       maxArea: 200
  #       minArea: 10
  - name: Schutzflächeumgrenzung Schraffur
    sync: push
    style: schutzflächeumgrenzung
    applyHatch:
      layers:
        - Ausgleich Schutzflächeumgrenzung
  # - name: Baufeld Negative
  #   operations:
  #     - type: copy
  #       layers:
  #         - Landwirtschaftliche Nutzung
  #         - Hecke
  #         - Biotope
  #         - Biotoppuffer
  #     - type: dissolve
  #       useBufferTrick: true
  - name: AgriPV Base
    # sync: push
    operations:
      - type: copy
        layers:
          - Geltungsbereich NW Base
          - Geltungsbereich NO Base
          - Geltungsbereich S Base
      - type: difference
        layers:
          - Soft Exclusions
          - Hard Exclusions
        reverseDifference: false
        useBufferTrick: true
      - type: filterGeometry
        minArea: 200
        geometryTypes:
          - Polygon
  - name: AgriPV Expansion
    # sync: push
    # Expand 20m into soft exclusions only
    operations:
      - type: buffer
        layers:
          - AgriPV Base
        distance: 20
        joinStyle: mitre
      - type: intersection
        layers:
          - Soft Exclusions
        useBufferTrick: true
  - name: AgriPV
    sync: push
    close: true
    viewports:
      - name: WorkView
        style: baufeld
    operations:
      - type: copy
        layers:
          - AgriPV Base
          - AgriPV Expansion
      - type: dissolve
        useBufferTrick: true
      - type: intersection
        layers:
          - Geltungsbereich NW Base
          - Geltungsbereich NO Base
          - Geltungsbereich S Base
      - type: filterGeometry
        minArea: 200
        geometryTypes:
          - Polygon
  - name: Geltungsbereich NW
    sync: push
    style: geltungsbereich
    operations:
      - type: intersection
        layers:
          - AgriPV
          - Geltungsbereich NW Base
  - name: Geltungsbereich NO
    sync: push
    style: geltungsbereich
    operations:
      - type: intersection
        layers:
          - AgriPV
          - Geltungsbereich NO Base
  - name: Geltungsbereich S
    sync: push
    style: geltungsbereich
    operations:
      - type: intersection
        layers:
          - AgriPV
          - Geltungsbereich S Base
  - name: Baugrenze Temp
    # sync: push
    operations:
      - type: buffer
        layers:
          - AgriPV
        distance: -20
        joinStyle: round
        quadSegs: 16
      - type: difference
        reverseDifference: false
        layers:
          - FG Buffer
          - Gastrasse Buffer
          - Einfahrt
          - Exclude Baugrenze
  - name: Landwirtschaftliche Nutzung
    sync: push
    style:
      layer:
        color: "lime"
        plot: false
    viewports:
      - name: WorkView
        style: grünflächeWorkView
    operations:
      - type: copy
        layers:
          - Landwirtschaftliche Nutzung Base
  - name: AgriPV Schraffur
    sync: push
    style: baufeld
    applyHatch:
      layers:
        - AgriPV
  - name: Baugrenze 2
    sync: push
    style: baugrenze_2
    close: true
    operations:
      - type: buffer
        layers:
          - Baugrenze
        distance: -0.4
        joinStyle: mitre
  - name: Baugrenze
    sync: push
    style: baugrenze
    linetypeScale: 0.5
    linetypeGeneration: true
    close: true
    operations:
      - type: copy
        layers:
          - Baugrenze Temp
  - name: Baugrenze Report NW
    operations:
      - type: copy
        layers:
          - Baugrenze
      - type: intersection
        layers:
          - Geltungsbereich NW
      - type: report
        outputFile: "Öffentlich Planungsbüro Schulz/Projekte/23-24 Maxsolar - Plasten/GIS/reports/baugrenze_nw_report.json"
        calculate:
          - area
          - perimeter
        decimalPlaces:
          area: 0
  - name: Baugrenze Report NO
    operations:
      - type: copy
        layers:
          - Baugrenze
      - type: intersection
        layers:
          - Geltungsbereich NO
      - type: report
        outputFile: "Öffentlich Planungsbüro Schulz/Projekte/23-24 Maxsolar - Plasten/GIS/reports/baugrenze_no_report.json"
        calculate:
          - area
          - perimeter
        decimalPlaces:
          area: 0
  - name: Baugrenze Report S
    operations:
      - type: copy
        layers:
          - Baugrenze
      - type: intersection
        layers:
          - Geltungsbereich S
      - type: report
        outputFile: "Öffentlich Planungsbüro Schulz/Projekte/23-24 Maxsolar - Plasten/GIS/reports/baugrenze_s_report.json"
        calculate:
          - area
          - perimeter
        decimalPlaces:
          area: 0
  - name: AgriPV Streifen Report NW
    operations:
      - type: copy
        layers:
          - AgriPV
      - type: difference
        layers:
          - Baugrenze
        reverseDifference: false
      - type: intersection
        layers:
          - Geltungsbereich NW
      - type: report
        outputFile: "Öffentlich Planungsbüro Schulz/Projekte/23-24 Maxsolar - Plasten/GIS/reports/baufeldstreifen_nw_report.json"
        calculate:
          - area
          - perimeter
        decimalPlaces:
          area: 0
  - name: AgriPV Streifen Report NO
    operations:
      - type: copy
        layers:
          - AgriPV
      - type: difference
        layers:
          - Baugrenze
        reverseDifference: false
      - type: intersection
        layers:
          - Geltungsbereich NO
      - type: report
        outputFile: "Öffentlich Planungsbüro Schulz/Projekte/23-24 Maxsolar - Plasten/GIS/reports/baufeldstreifen_no_report.json"
        calculate:
          - area
          - perimeter
        decimalPlaces:
          area: 0
  - name: AgriPV Streifen Report S
    operations:
      - type: copy
        layers:
          - AgriPV
      - type: difference
        layers:
          - Baugrenze
        reverseDifference: false
      - type: intersection
        layers:
          - Geltungsbereich S
      - type: report
        outputFile: "Öffentlich Planungsbüro Schulz/Projekte/23-24 Maxsolar - Plasten/GIS/reports/baufeldstreifen_s_report.json"
        calculate:
          - area
          - perimeter
        decimalPlaces:
          area: 0
  # - name: Contour
  #   sync: push
  #   style:
  #     color: white
  #     locked: false
  #   label: elevation
  #   operations:
  #     - type: contour
  #       url: "https://www.geodaten-mv.de/dienste/dgm_atom?type=dataset&id=df758744-b2a1-4d39-b34c-9ec5bf9b4372"
  #       layers:
  #         - Geltungsbereich NW
  #       buffer: 1000
