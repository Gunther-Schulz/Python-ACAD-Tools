geomLayers:
  ### Grundlagen ###
  - name: parcel
    # sync: push
    shapeFile: "Öffentlich Planungsbüro Schulz/Projekte/22-16 Maxsolar - Friedrichshof/GIS/input/parcel.shp"

  - name: flur
    shapeFile: "Öffentlich Planungsbüro Schulz/Projekte/22-16 Maxsolar - Friedrichshof/GIS/input/flur.shp"

  - name: gemarkung
    shapeFile: "Öffentlich Planungsbüro Schulz/Projekte/22-16 Maxsolar - Friedrichshof/GIS/input/gemarkung.shp"

  - name: Geltungsbereich input
    # sync: push
    shapeFile: "Öffentlich Planungsbüro Schulz/Projekte/22-16 Maxsolar - Friedrichshof/GIS/input/Geltungsbereich input.shp"

  - name: Grünfläche
    sync: pull
    operations:
      - type: filterGeometry
        geometryTypes:
          - Polygon

  - name: CEF input
    # sync: push
    shapeFile: "Öffentlich Planungsbüro Schulz/Projekte/22-16 Maxsolar - Friedrichshof/GIS/input/CEF.shp"

  - name: CIO input
    # sync: push
    shapeFile: "Öffentlich Planungsbüro Schulz/Projekte/22-16 Maxsolar - Friedrichshof/GIS/input/GIO - Intensivgrünland auf Moorstandorten.shp"

  - name: ACL - Lehm- bzw. Tonacker
    # sync: push
    shapeFile: "Öffentlich Planungsbüro Schulz/Projekte/22-16 Maxsolar - Friedrichshof/GIS/input/ACL - Lehm- bzw. Tonacker.shp"
    operations:
      - type: intersection
        layers:
          - Geltungsbereich input

  - name: Biotop unten links
    # sync: push
    shapeFile: "Öffentlich Planungsbüro Schulz/Projekte/22-16 Maxsolar - Friedrichshof/GIS/input/Biotop unten links.shp"

  - name: Baumreihe Linie
    sync: pull

  - name: Baum Puffer
    operations:
      - type: buffer
        layers:
          - Baumreihe Linie
        distance: 6

  - name: Baufeld
    sync: push
    shapeFile: "Öffentlich Planungsbüro Schulz/Projekte/22-16 Maxsolar - Friedrichshof/GIS/input/Baufeld input.shp"
    operations:
      - type: dissolve

  - name: CEF Biotop
    operations:
      - type: copy
        layers:
          - name: "CEF input"
      - type: difference
        reverseDifference: false
        layers:
          - name: "CIO input"

  - name: Baufeld Schraffur
    sync: push
    style: baufeld
    applyHatch:
      layers:
        - Baufeld

  - name: Baugrenze
    sync: push
    style: baugrenze
    linetypeScale: 0.5
    linetypeGeneration: true
    close: true
    operations:
      - type: buffer
        joinStyle: mitre
        layers:
          - Baufeld
        distance: -3
      - type: difference
        reverseDifference: false
        layers:
          - Baum Puffer

  - name: Baugrenze 2
    sync: push
    style: baugrenze_2
    close: true
    operations:
      - type: buffer
        joinStyle: mitre
        layers:
          - Baugrenze
        distance: -0.4

  ### Reports ###
  - name: "Baufeld Report"
    operations:
      - type: copy
        layers:
          - Baufeld
      - type: calculate
        calculations:
          - type: area
            as: area
            decimalPlaces: 0
          - type: perimeter
            as: perimeter
            decimalPlaces: 1
      - type: report
        outputFile: "Öffentlich Planungsbüro Schulz/Projekte/22-16 Maxsolar - Friedrichshof/GIS/reports/baufeld_report.json"
        featureColumns:
          - area
          - perimeter
        calculate:
          - area
          - perimeter
        decimalPlaces:
          area: 0
          perimeter: 1

  - name: "Baugrenze Report"
    operations:
      - type: copy
        layers:
          - Baugrenze
      - type: calculate
        calculations:
          - type: area
            as: area
            decimalPlaces: 0
          - type: perimeter
            as: perimeter
            decimalPlaces: 1
      - type: report
        outputFile: "Öffentlich Planungsbüro Schulz/Projekte/22-16 Maxsolar - Friedrichshof/GIS/reports/baugrenze_report.json"
        featureColumns:
          - area
          - perimeter
        calculate:
          - area
          - perimeter
        decimalPlaces:
          area: 0
          perimeter: 1

  - name: "Baufeldstreifen Report"
    operations:
      - type: copy
        layers:
          - Baufeld
      - type: difference
        reverseDifference: false
        layers:
          - Baugrenze
      - type: calculate
        calculations:
          - type: area
            as: area
            decimalPlaces: 0
          - type: perimeter
            as: perimeter
            decimalPlaces: 1
      - type: report
        outputFile: "Öffentlich Planungsbüro Schulz/Projekte/22-16 Maxsolar - Friedrichshof/GIS/reports/baufeldstreifen_report.json"
        featureColumns:
          - area
          - perimeter
        calculate:
          - area
          - perimeter
        decimalPlaces:
          area: 0
          perimeter: 1

  ### Grünfläche ###
  - name: "Grünfläche Naturschutz"
    # sync: push
    operations:
      - type: dissolve
        layers:
          - name: "CEF input"
          - name: "Biotop unten links"
      - type: repair
      - type: dissolve
      - type: repair
      - type: removeSliversErosion
        erosionDistance: 0.1
      - type: repair
      - type: filterGeometry
        minArea: 20
        geometryTypes:
          - Polygon
      - type: calculate
        calculations:
          - type: area
            as: area
            decimalPlaces: 0
      - type: report
        outputFile: "Öffentlich Planungsbüro Schulz/Projekte/22-16 Maxsolar - Friedrichshof/GIS/reports/grünfläche_report.json"
        featureColumns:
          - area
        calculate:
          - area
        decimalPlaces:
          area: 0

  # Create inner green area (buffered inward) for hatching
  - name: "Ausgleich Grünfläche"
    sync: push
    operations:
      - type: copy
        layers:
          - "Grünfläche Naturschutz"
      - type: dissolve
      - type: buffer
        distance: -2
        joinStyle: round
        preserveIslands: true

  - name: "Grünfläche Schraffur"
    sync: push
    style: grünfläche
    applyHatch:
      layers:
        - "Ausgleich Grünfläche"

  # T-Line system for protection area boundaries (ring from original area)
  - name: "Ausgleich Schutzflächeumgrenzung"
    sync: push
    operations:
      - type: copy
        layers:
          - "Grünfläche Naturschutz"
      - type: buffer
        distance: -2
        joinStyle: round
        mode: ring

  - name: "Grünfläche T-Linie Symbol Schraffur"
    sync: push
    style: schutzflächeumgrenzung
    applyHatch:
      layers:
        - "Ausgleich Schutzflächeumgrenzung"

  - name: Parcel Intersections
    operations:
      - type: copy
        layers:
          - name: parcel
      - type: calculate
        calculations:
          - type: area
            as: parcel_area
            decimalPlaces: 0
      - type: intersection
        layers:
          - name: Geltungsbereich input
      - type: filterGeometry
        minArea: 10
        geometryTypes:
          - polygon
      - type: calculate
        calculations:
          - type: area
            as: intersection_area
            decimalPlaces: 0
      - type: report
        outputFile: "Öffentlich Planungsbüro Schulz/Projekte/22-16 Maxsolar - Friedrichshof/GIS/reports/parcel_intersections_report.json"
        featureColumns:
          - label
          - parcel_area
          - intersection_area
        calculate:
          - area
        decimalPlaces:
          intersection_area: 0
          area: 0
