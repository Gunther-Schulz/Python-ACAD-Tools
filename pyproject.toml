# Tool configuration for Python development tools

[tool.black]
line-length = 100
target-version = ['py312']
include = '\.pyi?$'
extend-exclude = '''
# A regex preceded with ^/ will apply only to files and directories
# in the root of the project.
^/tests/
'''

[tool.isort]
profile = "google"
multi_line_output = 3
line_length = 100
include_trailing_comma = true
force_grid_wrap = 0
use_parentheses = true
ensure_newline_before_comments = true
src_paths = ["src", "tests"]
known_first_party = ["src"]
sections = ["FUTURE", "STDLIB", "THIRDPARTY", "FIRSTPARTY", "LOCALFOLDER"]
import_heading_stdlib = "Standard library imports"
import_heading_thirdparty = "Third party imports"
import_heading_firstparty = "First party imports"
import_heading_localfolder = "Local imports"
import_type_order = ["local", "parent", "third_party"]
order_by_type = true
combine_as_imports = true
combine_star = true

[tool.mypy]
python_version = "3.12"
warn_return_any = true
warn_unused_configs = true
disallow_untyped_defs = true
disallow_incomplete_defs = true
check_untyped_defs = true
disallow_untyped_decorators = true
no_implicit_optional = true
warn_redundant_casts = true
warn_unused_ignores = true
warn_no_return = true
warn_unreachable = true
strict = true
plugins = [
    "numpy.typing.mypy_plugin"
]

[[tool.mypy.overrides]]
module = ["shapely.*", "ezdxf.*", "geopandas.*", "matplotlib.*", "OWSLib.*"]
ignore_missing_imports = true

[tool.pylint]
max-line-length = 100
disable = [
    "C0111",  # Missing docstring (covered by flake8-docstrings)
    "C0103",  # Invalid name (we use our own naming convention)
    "R0903",  # Too few public methods
    "W0511",  # TODO/FIXME comments
    "W0703",  # Too general exception clause
]

# Import rules from ARCHITECTURE.md
ignore-imports = true
ignored-modules = [
    "src.core.*",
    "src.config.*",
    "src.geometry.*",
    "src.export.*"
]
ignored-classes = [
    "src.core.*",
    "src.config.*",
    "src.geometry.*",
    "src.export.*"
]

# Allow imports only in specific files
ignore-paths = [
    "src/.*/dependencies\\.py$",
    "src/.*/__init__\\.py$"
]

# Naming style
good-names = ["i", "j", "k", "ex", "Run", "_", "id"]
class-rgx = "[A-Z_][a-zA-Z0-9]+$"
function-rgx = "[a-z_][a-z0-9_]{2,50}$"
variable-rgx = "[a-z_][a-z0-9_]{2,50}$"
const-rgx = "(([A-Z_][A-Z0-9_]*)|(__.*__))$"

# Design rules
max-args = 6
max-locals = 15
max-returns = 6
max-branches = 12
max-statements = 50
max-parents = 7
max-attributes = 7
min-public-methods = 1
max-public-methods = 20
